module.exports = function(dir, db, logger)
{
	this.dir = dir;
	this.db = db;
	this.logger = logger;
}

module.exports.prototype =
{
	"build": function(cb)
	{
		this._series(
		[
			this._prepareDirs,
			this._prepareMedia,
			this._buildTree,
			this._writeFiles
		], cb);
	},

	"_series": function series(funcs, cb)
	{
		if (funcs[1] === undefined)
		{
			funcs[0].call(this, cb);
		}
		else
		{
			funcs[0].call(this, function()
			{
				funcs.splice(0, 1);
				this._series(funcs, cb);
			}.bind(this));
		}
	},

	"_prepareDirs": require("./prepareDirs.js"),

	"_prepareMedia": require("./prepareMedia.js"),

	"_buildTree": require("./buildTree.js"),

	"_writeFiles": require("./writeFiles.js"),
}

